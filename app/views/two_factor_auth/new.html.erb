<% provide(:title, "Set up two factor authentication") %>

<div>
    <h2 style="text-align: left !important; font-size: 1.9 !important"><%= @user.name %>'s Account Settings</h2>
    <hr class="style1">
</div>

<div>
    <h3>Two factor authentication setup</h3>
    <div>
        <p>Open Google Authenticator. Select "Add account" or "+" and scan the QR code below:</p>
        <%= image_tag(@qr.to_data_url, size: "400x400", class: "img-thumbnail img-responsive center-block") %>
        <br>        
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#step-one" aria-controls="step-one" role="tab" data-toggle="tab">Step 1</a></li>
            <li role="presentation"><a href="#next" aria-controls="next" role="tab" data-toggle="tab">Next</a></li>
        </ul>
        <!-- Tab panes -->
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="step-one">
                <div>
                    <p style="display: inline-block">Enter your secret key manually if you're unable to scan the QR code: </p>
                    <pre style="overflow: inherit; display: inline-block"><%= @secret_2fa %></pre>
                </div>
            </div>
            <div role="tabpanel" class="tab-pane" id="next">
                <div class="row">
                    <div class="col-md-6 col-md-offset-3">
                        <p>Enter the security code generated by your mobile authenticator app to make sure itâ€™s configured correctly.</p>
                        <%= form_for(:twoFA, url: two_factor_auth_verify_path) do |f| %>
                            <%= f.hidden_field :twoFA_userId, value: @user.id, class: "form-control" %>  
                            <%= f.text_field :otp, class: "form-control" %>
                            <%= f.submit "Submit" %>
                        <% end %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
